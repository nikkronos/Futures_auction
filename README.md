# –í–∏–¥–∂–µ—Ç ¬´–¢–∞–±–ª–∏—Ü–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤¬ª ‚Äî –¢-–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏

–í–µ–±-–≤–∏–¥–∂–µ—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ñ—å—é—á–µ—Ä—Å–∞–º –∏ —Å–ø–æ—Ç-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º –¢-–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–µ–∂–∏–º–æ–≤ ¬´–°–≤–µ—á–∏¬ª –∏ ¬´–°—Ç–∞–∫–∞–Ω¬ª, –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –≤—ã–±–æ—Ä–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç, –∑–∞–¥–µ–ø–ª–æ–µ–Ω–æ –Ω–∞ Timeweb  
**URL:** http://81.200.146.32:5000  
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/nikkronos/Futures_auction

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–ø–∏—Å–∞–Ω–∏–µ](#–æ–ø–∏—Å–∞–Ω–∏–µ)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å](#—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-–¥–µ—Ç–∞–ª–∏)
- [–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (2026-02-12)](#–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è-2026-02-12)
- [–î–µ–ø–ª–æ–π](#–¥–µ–ø–ª–æ–π)
- [–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞](#—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

---

## –û–ø–∏—Å–∞–Ω–∏–µ

–í–∏–¥–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (—Ñ—å—é—á–µ—Ä—Å—ã, —Å–ø–æ—Ç) —Å –¥–∞–Ω–Ω—ã–º–∏:
- **–†–µ–∂–∏–º ¬´–°–≤–µ—á–∏¬ª**: –ê–∫—Ç–∏–≤, –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è, –¶–µ–Ω–∞ –∞—É–∫—Ü–∏–æ–Ω–∞, –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ %, –õ–æ—Ç—ã
- **–†–µ–∂–∏–º ¬´–°—Ç–∞–∫–∞–Ω¬ª**: Bid, Ask, –¶–µ–Ω–∞ –∞—É–∫—Ü–∏–æ–Ω–∞, –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ %, –õ–æ—Ç—ã

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç (–≤–æ –≤—Ä–µ–º—è –∞—É–∫—Ü–∏–æ–Ω–∞ ‚Äî –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏: –≤—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –ø–æ–∏—Å–∫, —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –≤ localStorage
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∞—É–∫—Ü–∏–æ–Ω–∞ –ø–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ (–ú–°–ö)

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Damir/
‚îú‚îÄ‚îÄ server.py              # Flask-–±—ç–∫–µ–Ω–¥ (REST API)
‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îî‚îÄ‚îÄ index.html        # –§—Ä–æ–Ω—Ç–µ–Ω–¥ (HTML + CSS + JS)
‚îú‚îÄ‚îÄ README.md             # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ ROADMAP_DAMIR.md      # –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è
‚îî‚îÄ‚îÄ DONE_LIST_DAMIR.md    # –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

**–ë—ç–∫–µ–Ω–¥:**
- Python 3.8+
- Flask (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)
- requests (HTTP-–∫–ª–∏–µ–Ω—Ç –¥–ª—è T-Invest API)
- threading (–ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫—ç—à)

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:**
- Vanilla JavaScript (–±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤)
- HTML5 + CSS3
- localStorage (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫)

**API:**
- T-Invest REST API (https://invest-public-api.tbank.ru/rest/)
- Endpoints: `/instruments/futures`, `/market/candles`, `/market/orderbook`

---

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 1. –¢–∞–±–ª–∏—Ü–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

**–†–µ–∂–∏–º ¬´–°–≤–µ—á–∏¬ª:**
- –ê–∫—Ç–∏–≤ (–Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞)
- –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è (–≤—á–µ—Ä–∞—à–Ω—è—è –¥–Ω–µ–≤–Ω–∞—è —Å–≤–µ—á–∞)
- –¶–µ–Ω–∞ –∞—É–∫—Ü–∏–æ–Ω–∞ (—Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è)
- –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ % (–æ—Ç –≤—á–µ—Ä–∞—à–Ω–µ–π —Ü–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è –¥–æ —Ü–µ–Ω—ã –∞—É–∫—Ü–∏–æ–Ω–∞)
- –õ–æ—Ç—ã (–æ–±—ä—ë–º)

**–†–µ–∂–∏–º ¬´–°—Ç–∞–∫–∞–Ω¬ª:**
- Bid (–ª—É—á—à–∞—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏)
- Ask (–ª—É—á—à–∞—è —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏)
- –¶–µ–Ω–∞ –∞—É–∫—Ü–∏–æ–Ω–∞
- –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ % (–æ—Ç –≤—á–µ—Ä–∞—à–Ω–µ–π —Ü–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è –¥–æ —Ü–µ–Ω—ã –∞—É–∫—Ü–∏–æ–Ω–∞)
- –õ–æ—Ç—ã (—Å—É–º–º–∞—Ä–Ω—ã–π –æ–±—ä—ë–º –ø–æ —É—Ä–æ–≤–Ω—è–º)

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏

- **–í—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**: —Å–ø–∏—Å–æ–∫ —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏ (–¥–æ 20 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
- **–ü–æ–∏—Å–∫**: —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é/—Ç–∏–∫–µ—Ä—É
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏**: –ú–µ—Ç–∞–ª–ª—ã, –ö—Ä–∏–ø—Ç–∞, –ò–Ω–¥–µ–∫—Å—ã, –í–∞–ª—é—Ç—ã, –¢–æ–≤–∞—Ä—ã, –ê–∫—Ü–∏–∏
- **–î–µ–π—Å—Ç–≤–∏—è**: –í—ã–±—Ä–∞—Ç—å –≤—Å–µ / –°–Ω—è—Ç—å –≤—Å–µ / –í—ã–±—Ä–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ

### 3. –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

- **–û–±—ã—á–Ω–æ–µ –≤—Ä–µ–º—è**: –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
- **–í—Ä–µ–º—è –∞—É–∫—Ü–∏–æ–Ω–∞**: –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
  - –û—Ç–∫—Ä—ã—Ç–∏–µ: –ü–Ω-–ü—Ç 8:45-9:05 –ú–°–ö, –°–±-–í—Å 9:45-10:05 –ú–°–ö
  - –ó–∞–∫—Ä—ã—Ç–∏–µ: 18:35-18:55 –ú–°–ö (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å)
- –ö–Ω–æ–ø–∫–∞ ¬´–ê–≤—Ç–æ: –í–ö–õ/–í–´–ö–õ¬ª –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞: ¬´–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ X –º–∏–Ω/—Å–µ–∫¬ª

### 4. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞

- –ü–æ –≤—Å–µ–º –∫–æ–ª–æ–Ω–∫–∞–º (–∫–ª–∏–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É)
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (‚Üë‚Üì)

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ 2026-02-12):**
- –ö–Ω–æ–ø–∫–∏ ¬´–ù–∞—Å—Ç—Ä–æ–π–∫–∏¬ª, ¬´–†–µ–∂–∏–º: –°–≤–µ—á–∏¬ª, ¬´–ê–≤—Ç–æ: –í–ö–õ¬ª –∏–º–µ–ª–∏ **–¥–≤–æ–π–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏**:
  - Inline `onclick` –≤ HTML
  - `addEventListener` –≤ JavaScript
- –ü—Ä–∏ –∫–ª–∏–∫–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏ –æ–±–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ ‚Üí –ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–ª–∞—Å—å –∏ —Å—Ä–∞–∑—É –∑–∞–∫—Ä—ã–≤–∞–ª–∞—Å—å, —Ä–µ–∂–∏–º –ø–µ—Ä–µ–∫–ª—é—á–∞–ª—Å—è –¥–≤–∞–∂–¥—ã

**–†–µ—à–µ–Ω–∏–µ:**
- –£–¥–∞–ª–µ–Ω—ã `addEventListener` –¥–ª—è —ç—Ç–∏—Ö —Ç—Ä—ë—Ö –∫–Ω–æ–ø–æ–∫
- –û—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ inline `onclick` —Å –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–π —á–µ—Ä–µ–∑ `try/catch`
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ (`toggleSettings`, `toggleMode`, `toggleAutoRefresh`) –æ–±—ë—Ä–Ω—É—Ç—ã –≤ `try/catch` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–ö–æ–¥ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:**

```html
<!-- Inline onclick —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –æ—à–∏–±–æ–∫ -->
<button onclick="try{if(typeof toggleSettings==='function')toggleSettings();}catch(e){console.error('Settings',e);}">
  –ù–∞—Å—Ç—Ä–æ–π–∫–∏
</button>
<button onclick="try{if(typeof toggleMode==='function')toggleMode();}catch(e){console.error('Mode',e);}">
  –†–µ–∂–∏–º: –°–≤–µ—á–∏
</button>
<button onclick="try{if(typeof toggleAutoRefresh==='function')toggleAutoRefresh();}catch(e){console.error('Auto',e);}">
  –ê–≤—Ç–æ: –í–ö–õ
</button>
```

**–§—É–Ω–∫—Ü–∏–∏ —Å –∑–∞—â–∏—Ç–æ–π:**

```javascript
function toggleSettings() {
  try {
    const panel = document.getElementById('settingsPanel');
    if (!panel) return;
    // –°–Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
    panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
    if (panel.style.display === 'none') return;
    // –ü–æ—Ç–æ–º –ø–æ–¥–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
    // ...
  } catch (e) { console.error('toggleSettings', e); }
}
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ë—ç–∫–µ–Ω–¥ (`server.py`):**
- –°–ø–∏—Å–æ–∫ —Ñ—å—é—á–µ—Ä—Å–æ–≤: TTL 5 –º–∏–Ω—É—Ç
- –°–≤–µ—á–∏: TTL 10 —Å–µ–∫—É–Ω–¥
- –°—Ç–∞–∫–∞–Ω: TTL 5 —Å–µ–∫—É–Ω–¥
- –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π in-memory –∫—ç—à —Å `threading.Lock`

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ –∫—ç—à–∞, —Å–∫–æ–ª—å–∫–æ —Å–≤–µ–∂–∏—Ö
- –ü—Ä–∏–º–µ—Ä: `[INFO] Cache hit: futures_list` –∏–ª–∏ `[INFO] Cache miss: candles_SI-3.26`

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∞—É–∫—Ü–∏–æ–Ω–∞

**–ú–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è (–ú–°–ö = UTC+3):**
- –°—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ UTC, –∞ –Ω–µ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- –§—É–Ω–∫—Ü–∏—è `getRefreshInterval()` –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- Watcher –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–µ –Ω–∞—Å—Ç—É–ø–∏–ª–æ –ª–∏ –≤—Ä–µ–º—è –∞—É–∫—Ü–∏–æ–Ω–∞

**–ö–æ–¥:**

```javascript
function getRefreshInterval() {
  const now = new Date();
  const utcHour = now.getUTCHours();
  const utcMinute = now.getUTCMinutes();
  const mskTotalMin = (utcHour + 3) * 60 + utcMinute;
  const mskMinOfDay = mskTotalMin % (24 * 60);
  const mskHour = Math.floor(mskMinOfDay / 60);
  const mskMinute = mskMinOfDay % 60;
  const timeMinutes = mskHour * 60 + mskMinute;
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –∞—É–∫—Ü–∏–æ–Ω–∞
  // ...
}
```

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω

- **‚â•1000**: 2 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
- **‚â•1**: 4 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
- **<1**: 6 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –Ω—É–ª–µ–π (17070.0000 ‚Üí 17070)

### –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤ %

**–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–æ–≤:**
- –°—á–∏—Ç–∞–µ—Ç—Å—è –æ—Ç **–≤—á–µ—Ä–∞—à–Ω–µ–π —Ü–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è** (–∏–∑ –¥–Ω–µ–≤–Ω—ã—Ö —Å–≤–µ—á–µ–π) –¥–æ **—Ü–µ–Ω—ã –∞—É–∫—Ü–∏–æ–Ω–∞**
- –§–æ—Ä–º—É–ª–∞: `((auctionPrice - yesterdayClose) / yesterdayClose) * 100`

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (2026-02-12)

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞

**–°–∏–º–ø—Ç–æ–º—ã:**
1. –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è ¬´–ù–∞—Å—Ç—Ä–æ–π–∫–∏¬ª –ø–∞–Ω–µ–ª—å –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
2. –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è ¬´–†–µ–∂–∏–º: –°–≤–µ—á–∏¬ª —ç–∫—Ä–∞–Ω –Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
3. –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è ¬´–ê–≤—Ç–æ: –í–ö–õ¬ª –∫–Ω–æ–ø–∫–∞ –∑–∞–≥–æ—Ä–∞–µ—Ç—Å—è, –Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
4. –ö–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–ü—Ä–∏—á–∏–Ω–∞:**
- –î–≤–æ–π–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π (inline `onclick` + `addEventListener`)
- –ü—Ä–∏ –∫–ª–∏–∫–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏ –æ–±–∞ ‚Üí –ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–ª–∞—Å—å –∏ —Å—Ä–∞–∑—É –∑–∞–∫—Ä—ã–≤–∞–ª–∞—Å—å
- –û—à–∏–±–∫–∏ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å ‚Üí –ª–æ–º–∞–ª—Å—è –≤–µ—Å—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**–†–µ—à–µ–Ω–∏–µ:**

1. **–£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ `addEventListener`:**
   ```javascript
   // –£–î–ê–õ–ï–ù–û:
   // document.getElementById('btnSettings').addEventListener('click', toggleSettings);
   // document.getElementById('btnMode').addEventListener('click', toggleMode);
   // document.getElementById('btnAutoRefresh').addEventListener('click', toggleAutoRefresh);
   ```

2. **–£–ø—Ä–æ—â–µ–Ω—ã inline `onclick`:**
   - –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π —á–µ—Ä–µ–∑ `try/catch`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º

3. **–î–æ–±–∞–≤–ª–µ–Ω—ã `try/catch` –≤ —Ñ—É–Ω–∫—Ü–∏–∏:**
   - `toggleSettings()` ‚Äî –ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, —Å–ø–∏—Å–æ–∫ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
   - `toggleMode()` ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –æ—à–∏–±–æ–∫
   - `toggleAutoRefresh()` ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –æ—à–∏–±–æ–∫

4. **–ü—Ä–æ–≤–µ—Ä–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ DOM:**
   - –í—Å–µ `getElementById` –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ `null` –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
- ‚úÖ –†–µ–∂–∏–º –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
- ‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
- ‚úÖ –û—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å, –Ω–æ –Ω–µ –ª–æ–º–∞—é—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

**–ö–æ–º–º–∏—Ç:** `58d1de9` ‚Äî "fix: –ù–∞—Å—Ç—Ä–æ–π–∫–∏/–†–µ–∂–∏–º/–ê–≤—Ç–æ ‚Äî –æ–¥–∏–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, try/catch, –ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É"

---

## –î–µ–ø–ª–æ–π

### –°–µ—Ä–≤–µ—Ä

- **–•–æ—Å—Ç–∏–Ω–≥:** Timeweb
- **IP:** 81.200.146.32
- **–ü–æ—Ä—Ç:** 5000
- **–ü—É—Ç—å:** `/opt/futures_auction`
- **–°–µ—Ä–≤–∏—Å:** `futures_auction.service` (systemd)

### –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

1. **–õ–æ–∫–∞–ª—å–Ω–æ (Windows):**
   ```bash
   cd Damir
   git add static/index.html
   git commit -m "–æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
   git push
   ```

2. **–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (Linux):**
   ```bash
   cd ~/Futures_auction
   git pull
   cp -r . /opt/futures_auction/
   # –ò–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ:
   # systemctl restart futures_auction
   ```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–§–∞–π–ª:** `env_vars.txt` (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)

```
TINKOFF_INVEST_TOKEN=your_token_here
SANDBOX=0  # 0 = –±–æ–µ–≤–æ–π –∫–æ–Ω—Ç—É—Ä, 1 = sandbox
```

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:** —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ `/opt/futures_auction/env_vars.txt`

### systemd —Å–µ—Ä–≤–∏—Å

**–§–∞–π–ª:** `/etc/systemd/system/futures_auction.service`

```ini
[Unit]
Description=Futures Auction Widget
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/futures_auction
Environment="PATH=/opt/futures_auction/.venv/bin:/usr/bin"
ExecStart=/opt/futures_auction/.venv/bin/python server.py
Restart=always

[Install]
WantedBy=multi-user.target
```

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
sudo systemctl enable futures_auction
sudo systemctl start futures_auction
sudo systemctl status futures_auction
```

---

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
   ```bash
   python -m venv .venv
   .venv\Scripts\activate  # Windows
   # –∏–ª–∏
   source .venv/bin/activate  # Linux/Mac
   pip install flask requests
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–∞:**
   - –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `env_vars.txt` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
   - –î–æ–±–∞–≤–∏—Ç—å: `TINKOFF_INVEST_TOKEN=your_token`

3. **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞:**
   ```bash
   python server.py
   ```
   –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ http://127.0.0.1:5000

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ API

**–ë—ç–∫–µ–Ω–¥ endpoints:**

- `GET /` ‚Äî –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–æ—Ç–¥–∞—ë—Ç `static/index.html`)
- `GET /api/futures` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ñ—å—é—á–µ—Ä—Å–æ–≤
- `GET /api/table?ids=...` ‚Äî –¥–∞–Ω–Ω—ã–µ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º (—Ä–µ–∂–∏–º ¬´–°–≤–µ—á–∏¬ª)
- `GET /api/orderbook?ids=...` ‚Äî –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞–∫–∞–Ω–∞ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º (—Ä–µ–∂–∏–º ¬´–°—Ç–∞–∫–∞–Ω¬ª)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl "http://127.0.0.1:5000/api/table?ids=BBG004730N88,BBG004730RP0"
```

### –û—Ç–ª–∞–¥–∫–∞

**–ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12):**
- –û—à–∏–±–∫–∏ JavaScript –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏: `Settings`, `Mode`, `Auto`
- –ü—Ä–∏–º–µ—Ä: `console.error('Settings', e)`

**–õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:**
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫—ç—à-—Ö–∏—Ç—ã/–º–∏—Å—Å—ã
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ—à–∏–±–∫–∏ API
- –§–æ—Ä–º–∞—Ç: `[INFO] Cache hit: futures_list`

---

## –°—Å—ã–ª–∫–∏

- [T-Invest API ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://developer.tbank.ru/invest/api)
- [T-Invest API ‚Äî –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã](https://developer.tbank.ru/invest/intro/intro/)
- [–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub](https://github.com/nikkronos/Futures_auction)

---

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 2026-02-12  
**–í–µ—Ä—Å–∏—è:** 3.0
